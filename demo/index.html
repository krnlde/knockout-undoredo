<!DOCTYPE html>
<html>
  <head>
    <title>Demo</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <style type="text/css"></style>
  </head>
  <body>
    <input type="text" placeholder="Type here..." data-bind="textInput: name"/>
    <button data-bind="click: undo">Undo</button>
    <button data-bind="click: redo">Redo</button>

    <h2 data-bind="text: message"></h2>
  </body>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/systemjs/0.19.41/system.js" integrity="sha256-XcUqNv8jyMENREIx9qqoRwOWTY5R+XS/WQ5nDXG1GsI=" crossorigin="anonymous"></script>
  <script type="text/javascript">
    System.defaultJSExtensions = true;
    System.config({
      baseURL: '../node_modules/',
      meta: {
        '../index.js': {
          babelOptions: {
            es2015: true,
            stage2: true,
          }
        }
      },
      map: {
        'knockout-undoredo':    '../index.js',
        'knockout':             '../node_modules/knockout/build/output/knockout-latest.debug.js',
        'plugin-babel':         '../node_modules/systemjs-plugin-babel/plugin-babel.js',
        'systemjs-babel-build': '../node_modules/systemjs-plugin-babel/systemjs-babel-browser.js',
      },
      transpiler: 'plugin-babel',
    });

    Promise.all(['knockout', 'knockout-undoredo'].map(s => System.import(s)))
      .then(function ([ko, {default: UndoManager}]) {
        class ViewModel {
          constructor() {
            this.name = ko.observable();
            this.message = ko.pureComputed(() => this.name() ? `Hello ${this.name()}, how are you?` : '');
          }

          undo() {
            undomanager.undo();
          }
          redo() {
            undomanager.redo();
          }
        }

        const vm = new ViewModel();
        let undomanager = new UndoManager(vm);
        ko.applyBindings(vm);
      });
  </script>
</html>
